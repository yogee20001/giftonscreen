<button type="button" onclick="save()">Preview</button>

<script>
async function save() {
  const res = await fetch("/api/save", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      mobile: document.querySelector('[name="mobile"]').value,
      to: document.querySelector('[name="to"]').value,
      from: document.querySelector('[name="from"]').value,
      template: new URLSearchParams(location.search).get("tpl"),
      media: document.querySelector('[name="media"]').value
    })
  });

  const data = await res.json();

  // Do NOT show unlock code to user
  // Admin will share it manually after payment

  window.location.href = "preview.html?id=" + data.id;
}
</script>

